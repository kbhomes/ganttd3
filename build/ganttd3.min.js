!function(a,b){"function"==typeof define&&define.amd?define(b):a.GanttD3=b()}(this,function(){var a,b,c;return function(d){function e(a,b){return u.call(a,b)}function f(a,b){var c,d,e,f,g,h,i,j,k,l,m=b&&b.split("/"),n=s.map,o=n&&n["*"]||{};if(a&&"."===a.charAt(0))if(b){for(m=m.slice(0,m.length-1),a=m.concat(a.split("/")),j=0;j<a.length;j+=1)if(l=a[j],"."===l)a.splice(j,1),j-=1;else if(".."===l){if(1===j&&(".."===a[2]||".."===a[0]))break;j>0&&(a.splice(j-1,2),j-=2)}a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((m||o)&&n){for(c=a.split("/"),j=c.length;j>0;j-=1){if(d=c.slice(0,j).join("/"),m)for(k=m.length;k>0;k-=1)if(e=n[m.slice(0,k).join("/")],e&&(e=e[d])){f=e,g=j;break}if(f)break;!h&&o&&o[d]&&(h=o[d],i=j)}!f&&h&&(f=h,g=i),f&&(c.splice(0,g,f),a=c.join("/"))}return a}function g(a,b){return function(){return n.apply(d,v.call(arguments,0).concat([a,b]))}}function h(a){return function(b){return f(b,a)}}function i(a){return function(b){q[a]=b}}function j(a){if(e(r,a)){var b=r[a];delete r[a],t[a]=!0,m.apply(d,b)}if(!e(q,a)&&!e(t,a))throw new Error("No "+a);return q[a]}function k(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function l(a){return function(){return s&&s.config&&s.config[a]||{}}}var m,n,o,p,q={},r={},s={},t={},u=Object.prototype.hasOwnProperty,v=[].slice;o=function(a,b){var c,d=k(a),e=d[0];return a=d[1],e&&(e=f(e,b),c=j(e)),e?a=c&&c.normalize?c.normalize(a,h(b)):f(a,b):(a=f(a,b),d=k(a),e=d[0],a=d[1],e&&(c=j(e))),{f:e?e+"!"+a:a,n:a,pr:e,p:c}},p={require:function(a){return g(a)},exports:function(a){var b=q[a];return"undefined"!=typeof b?b:q[a]={}},module:function(a){return{id:a,uri:"",exports:q[a],config:l(a)}}},m=function(a,b,c,f){var h,k,l,m,n,s,u=[];if(f=f||a,"function"==typeof c){for(b=!b.length&&c.length?["require","exports","module"]:b,n=0;n<b.length;n+=1)if(m=o(b[n],f),k=m.f,"require"===k)u[n]=p.require(a);else if("exports"===k)u[n]=p.exports(a),s=!0;else if("module"===k)h=u[n]=p.module(a);else if(e(q,k)||e(r,k)||e(t,k))u[n]=j(k);else{if(!m.p)throw new Error(a+" missing "+k);m.p.load(m.n,g(f,!0),i(k),{}),u[n]=q[k]}l=c.apply(q[a],u),a&&(h&&h.exports!==d&&h.exports!==q[a]?q[a]=h.exports:l===d&&s||(q[a]=l))}else a&&(q[a]=c)},a=b=n=function(a,b,c,e,f){return"string"==typeof a?p[a]?p[a](b):j(o(a,b).f):(a.splice||(s=a,b.splice?(a=b,b=c,c=null):a=d),b=b||function(){},"function"==typeof c&&(c=e,e=f),e?m(d,a,b,c):setTimeout(function(){m(d,a,b,c)},4),n)},n.config=function(a){return s=a,s.deps&&n(s.deps,s.callback),n},c=function(a,b,c){b.splice||(c=b,b=[]),e(q,a)||e(r,a)||(r[a]=[a,b,c])},c.amd={jQuery:!0}}(),c("../lib/almond",function(){}),c("underscore",[],function(){return _}),c("backbone",[],function(){return Backbone}),c("util/computedattribute",["require","underscore"],function(a){var b=a("underscore"),c=function(a,c){b.extend(this,c),this.attributes={_name:a},this.initialize&&this.initialize.call(this)};return c.prototype.get=function(){return this.hasForcedValue()?this.getForcedValue():this.compute()},c.prototype.set=function(a){this.setAttribute("_force",a)},c.prototype.hasForcedValue=function(){return"undefined"!=typeof this.getAttribute("_force")},c.prototype.getForcedValue=function(){return this.getAttribute("_force")},c.prototype.compute=function(){},c.prototype.getAttribute=function(a){return this.attributes[a]},c.prototype.setAttribute=function(a,b){this.attributes[a]=b},c}),c("util/base",["require","backbone","util/computedattribute"],function(a){var b=a("backbone"),c=a("util/computedattribute");return b.Model.extend({accessor:function(a){return function(b){return b.get.call(b,a)}},method:function(a){var b=Array.prototype.slice.call(arguments,1);return function(c){var d=Array.prototype.slice.call(arguments,1);return c[a].apply(c,b.concat(d))}},get:function(a,d){var e=b.Model.prototype.get.call(this,a);return e instanceof c&&!d?e.get():e},set:function(a,d){var e=b.Model.prototype.get.call(this,a);e instanceof c?e.set(d):b.Model.prototype.set.call(this,a,d)}})}),c("d3",[],function(){return d3}),c("util/util",["require","d3","underscore"],function(a){var b=a("d3"),c=a("underscore");return{plusPx:function(a){var b=function(a){return a+"px"};return c.isFunction(a)?c.compose(b,a):b(a)},accessorFilter:function(a,b){return c.filter(a,function(a){return c.isFunction(b)?b(a):a.get(b)})},fullDateFormat:b.time.format("%Y-%m-%d")}}),c("tasks/attributes/groupattribute",["require","util/computedattribute"],function(a){var b=a("util/computedattribute");return{create:function(a){return new b("group",{model:a,compute:function(){return this.model.get("tasks").length>0}})}}}),c("tasks/attributes/eststartdateattribute",["require","util/computedattribute"],function(a){var b=a("util/computedattribute");return{create:function(a){return new b("estStartDate",{model:a,initialize:function(){this.set(this.model.get("estStartDate"))},compute:function(){return this.model.get("group")?d3.min(this.model.get("tasks"),function(a){return a.get("estStartDate")}):void 0}})}}}),c("tasks/attributes/estenddateattribute",["require","util/computedattribute"],function(a){var b=a("util/computedattribute");return{create:function(a){return new b("estEndDate",{model:a,initialize:function(){this.set(this.model.get("estEndDate"))},compute:function(){return this.model.get("group")?d3.max(this.model.get("tasks"),function(a){return a.get("estEndDate")}):void 0}})}}}),c("tasks/attributes/actstartdateattribute",["require","util/computedattribute"],function(a){var b=a("util/computedattribute");return{create:function(a){return new b("actStartDate",{model:a,initialize:function(){this.set(this.model.get("actStartDate"))},compute:function(){return this.model.get("group")?d3.min(this.model.get("tasks"),function(a){return a.get("actStartDate")}):void 0}})}}}),c("tasks/attributes/actenddateattribute",["require","util/computedattribute"],function(a){var b=a("util/computedattribute");return{create:function(a){return new b("actEndDate",{model:a,initialize:function(){this.set(this.model.get("actEndDate"))},compute:function(){return this.model.get("group")&&_.every(this.model.get("tasks"),function(a){return a.get("actEndDate")})?d3.max(this.model.get("tasks"),function(a){return a.get("actEndDate")}):void 0}})}}}),c("tasks/attributes/colorattribute",["require","util/computedattribute"],function(a){var b=a("util/computedattribute");return{create:function(a){return new b("color",{model:a,initialize:function(){this.set(this.model.get("color")),this.setAttribute("_gantt",this.model.get("gantt")),this.getAttribute("_gantt")&&this.setAttribute("_settings",this.getAttribute("_gantt").get("settings"))},compute:function(){return this.getAttribute("_settings")&&"function"==typeof this.getAttribute("_settings").colorGenerator?this.getAttribute("_settings").colorGenerator(this.model):void 0}})}}}),c("tasks/attributes/completedattribute",["require","util/computedattribute"],function(a){var b=a("util/computedattribute");return{create:function(a){return new b("completed",{model:a,initialize:function(){this.set(this.model.get("completed"))},hasForcedValue:function(){return!this.model.get("group")&&!this.model.get("actEndDate")&&"undefined"!=typeof this.getAttribute("_force")},compute:function(){if(this.model.get("group")){var a=this.model.get("tasks"),b=d3.mean(_.map(a,function(a){return a.get("completed")}));return b=b.toFixed(0)==b?b.toFixed(0):b.toFixed(1)}return this.model.get("actStartDate")?this.model.get("actEndDate")?100:void 0:void 0}})}}}),c("tasks/task",["require","util/base","util/util","util/computedattribute","tasks/attributes/groupattribute","tasks/attributes/eststartdateattribute","tasks/attributes/estenddateattribute","tasks/attributes/actstartdateattribute","tasks/attributes/actenddateattribute","tasks/attributes/colorattribute","tasks/attributes/completedattribute","d3","underscore","backbone"],function(a){var b=a("util/base"),c=a("util/util"),d=(a("util/computedattribute"),a("tasks/attributes/groupattribute")),e=a("tasks/attributes/eststartdateattribute"),f=a("tasks/attributes/estenddateattribute"),g=a("tasks/attributes/actstartdateattribute"),h=a("tasks/attributes/actenddateattribute"),i=a("tasks/attributes/colorattribute"),j=a("tasks/attributes/completedattribute"),k=(a("d3"),a("underscore"));return a("backbone"),b.extend({defaults:{id:"",name:"",estStartDate:void 0,estEndDate:void 0,actStartDate:void 0,actEndDate:void 0,completed:0,collapsed:!1,visible:!0},initialize:function(){this.set("tasks",[]);var a,b,c="/";this.get("gantt")&&(a=this.get("gantt"),b=a.get("settings"),c=b.pathSeparator);var d=this.get("id").split(c),e=d.pop();this.set("path",d),this.set("pathName",e),this.initializeComputedProperties(b)},initializeComputedProperties:function(){this.set("group",d.create(this)),this.set("estStartDate",e.create(this)),this.set("estEndDate",f.create(this)),this.set("actStartDate",g.create(this)),this.set("actEndDate",h.create(this)),this.set("color",i.create(this)),this.set("completed",j.create(this))},getEstDuration:function(){if(!this.get("estStartDate")||!this.get("estEndDate"))return"";var a=(this.get("estEndDate")-this.get("estStartDate"))/864e5+1;return a+(1==a?" day":" days")},getPercentCompletion:function(){return this.get("completed")?this.get("completed")+"%":""},getFormattedDate:function(a){var b=this.get(a);return b?c.fullDateFormat(b):""},getBarColor:function(){return this.get("color").bar},getBarHeight:function(){var a=this.get("gantt").get("settings");return this.get("group")?a.groupHeight:a.barHeight},getBarCompletionTop:function(){var a=this.get("gantt").get("settings");return this.get("group")?(a.groupHeight-a.groupCompletionHeight)/2:(a.barHeight-a.barCompletionHeight)/2},getBarCompletionHeight:function(){var a=this.get("gantt").get("settings");return this.get("group")||!this.get("parent")?a.groupCompletionHeight:a.barCompletionHeight},getBarCompletionColor:function(){return this.get("color").completion},getRowHidden:function(){return this.get("collapsed")?"+":"â€“"},getIndentClass:function(){return"indent"+this.get("path").length},getRowFontWeight:function(){return this.get("group")?"bold":"normal"},getChildren:function(a){var b={};return b.children=this.get("tasks"),a||(b.descendants=b.children.map(function(a){return a.getChildren()})),b},toggleChildren:function(a,b,c){if(this.has("gantt")){this.get("gantt");var d,e=this.get("collapsed"),f=e;if(void 0===a&&(a=!0),0==a){if(void 0===b)return;f=c,d=b}else this.set("collapsed",!e),d=this.getChildren();d&&k.each(d.children,function(a,b){a.set("visible",f),a.get("group")&&!a.get("collapsed")&&a.toggleChildren(!1,d.descendants[b],f)})}},toString:function(){return"Task "+this.get("id")}})}),c("tasks/taskcollection",["require","tasks/task","backbone"],function(a){var b=a("tasks/task"),c=a("backbone");return c.Collection.extend({model:b})}),c("columns/column",["require","util/base","tasks/task"],function(a){var b=a("util/base");return a("tasks/task"),b.extend({defaults:{name:"",label:"",accessor:null},getColumnName:function(){return"column-"+this.get("name")},getRowName:function(){return"row-"+this.get("name")},renderHeading:function(a){var b=this.getColumnName();a.append("td").classed(b,!0).append("span").text(this.get("label"))},render:function(a,b){var c=this.getRowName(),d=this.get("accessor"),e=function(a){a.text(d)},f=a.selectAll("td."+c);f.selectAll("span").call(e);var g=b.append("td").classed(c,!0);g.append("span").call(e)},renderPopupData:function(a,b){if(this.get("label")&&this.get("accessor")){var c="popup-"+this.getRowName(),d=a.append("tr").classed(c,!0);d.append("td").text(this.get("label")+":"),d.append("td").text(this.get("accessor")(b))}}})}),c("columns/tasknamecolumn",["require","columns/column","tasks/task","underscore"],function(a){var b=a("columns/column"),c=a("tasks/task"),d=a("underscore");return b.extend({initialize:function(){this.set("name","name")},render:function(a,b){var e=this.getRowName(),f=this.get("gantt"),g=f.get("settings"),h=function(a){a.attr("class",c.prototype.method("getIndentClass")).classed(e+"-indent",!0)},i=function(a){a.text(c.prototype.method("getRowHidden")).style("visibility","hidden").filter(c.prototype.accessor("group")).style("visibility","visible").on("click",function(a){a.toggleChildren(),f.redraw()})},j=function(a){a.text(c.prototype.accessor("name")).attr("title",function(a){return a.get("description")?a.get("description"):a.get("name")}).on("click",function(a,b){g.linkCallback&&g.linkCallback.call(this,a,b)})},k=function(a){var b=a.filter(c.prototype.accessor("group")).filter(function(a){return d.some(a.get("tasks"),c.prototype.accessor("group"))});b.selectAll("a").remove(),b.append("a").classed(e+"-collapse-all",!0).text("[collapse all]").on("click",function(a){d.each(a.get("tasks"),function(a){a.get("group")&&!a.get("collapsed")&&a.toggleChildren()}),f.redraw()})},l=a.selectAll("td."+e);l.selectAll("span."+e+"-indent").call(h),l.selectAll("span."+e+"-show-hide").call(i),l.selectAll("span."+e+"-name").call(j),l.call(k);var m=b.append("td").classed(e,!0);m.append("span").call(h),m.append("span").classed(e+"-show-hide",!0).call(i),m.append("span").classed(e+"-name",!0).call(j),m.call(k)}})}),c("columns/taskbarscolumn",["require","columns/column","tasks/task","util/util","d3","underscore"],function(a){var b=a("columns/column"),c=a("tasks/task"),d=a("util/util"),e=a("d3"),f=a("underscore");return b.extend({initialize:function(){this.set("name","bars")},renderHeading:function(){},render:function(a,b){var g=this.getRowName(),h=this.get("gantt").get("settings"),i=function(a,b){a.style("left",function(a){return b(a)+"px"}).style("top",function(){return(h.rowHeight-2*h.barHeight)/2-2+"px"})},j=function(a,b){a.style("height",d.plusPx(c.prototype.method("getBarHeight"))).style("width",function(a){return Math.floor(b(a))+"px"}).style("background-color",c.prototype.method("getBarColor"))},k=function(a,b){a.style("top",d.plusPx(c.prototype.method("getBarCompletionTop"))).style("height",d.plusPx(c.prototype.method("getBarCompletionHeight"))).style("width",function(a){return Math.floor(b(a)*(a.get("completed")/100))+"px"}).style("background-color",c.prototype.method("getBarCompletionColor"))},l=function(a,b){a.style("left",function(a){return b(a)+"px"}).style("top",function(){return(h.rowHeight-2*h.barHeight)/2+h.barHeight-1+"px"})},m=function(a,b){a.style("height",d.plusPx(c.prototype.method("getBarHeight"))).style("width",function(a){return Math.floor(b(a))+"px"}).style("background-color",e.rgb("#AAA").toString())},n=function(a,b){a.style("top",d.plusPx(c.prototype.method("getBarCompletionTop"))).style("height",d.plusPx(c.prototype.method("getBarCompletionHeight"))).style("width",function(a){return Math.floor(b(a)*(a.get("completed")/100))+"px"}).style("background-color",e.rgb("#AAA").darker().toString())},o=e.select("table").selectAll("tr.row"),p=o.data(),q=h.interval;if(0!=p.length){var r=Math.min.apply(Math,f.filter([q.getMinGroup(p,"estStartDate"),q.getMinGroup(p,"actStartDate")],f.identity)),s=Math.max.apply(Math,f.filter([q.getMaxGroup(p,"estEndDate"),q.getMaxGroup(p,"actEndDate")],f.identity)),t=[r,s];q.setDomain(t);var u=q.getUnitSteps(),v=q.getGroupSteps(),w=u.length*q.get("unitWidth");q.setRange([0,w]);var x=q.getXScale(),y=q.getWidthScale(),z=e.select("tr.date-ranges").selectAll("td.date-range").data(v,f.identity),A=e.select("tr.columns").selectAll("td.day-cell").data(u,f.identity),B=a.selectAll("td."+g).attr("colspan",u.length),C=B.selectAll("div."+g+"-container");C.selectAll("div.overlay");var D=C.selectAll("div."+g+"-bars"),E=function(a){return x(a.get("estStartDate"))},F=function(a){return y(a.get("estStartDate"),a.get("estEndDate"))};D.selectAll("div.bar."+g+"-est").filter(function(a){return!a.get("estStartDate")||!a.get("estEndDate")}).remove();var G=D.filter(function(a){return a.get("estStartDate")&&a.get("estEndDate")}).selectAll("div.bar."+g+"-est").call(i,E);G.selectAll("div."+g+"-est-full").call(j,F),G.selectAll("div."+g+"-est-completed").call(k,F);var H=function(a){return x(a.get("actStartDate"))},I=function(a){return y(a.get("actStartDate"),a.get("actEndDate"))};D.selectAll("div.bar."+g+"-act").filter(function(a){return!a.get("actStartDate")||!a.get("actEndDate")}).remove();var J=D.filter(function(a){return a.get("actStartDate")&&a.get("actEndDate")}).selectAll("div.bar."+g+"-act").call(l,H);J.selectAll("div."+g+"-act-full").call(m,I),J.selectAll("div."+g+"-act-completed").call(n,I);var B=b.append("td").classed(g,!0).attr("colspan",u.length),C=B.append("div").classed(g+"-container",!0).classed("group",c.prototype.accessor("group"));C.append("div").classed("overlay",!0);var D=C.append("div").classed(g+"-bars",!0).on("mousemove",this.displayPopup(this)).on("mouseout",this.hidePopup),E=function(a){return x(a.get("estStartDate"))},F=function(a){return y(a.get("estStartDate"),a.get("estEndDate"))},G=D.filter(function(a){return a.get("estStartDate")&&a.get("estEndDate")}).append("div").classed(g+"-est",!0).classed("bar",!0).call(i,E);G.append("div").classed(g+"-est-full",!0).call(j,F),G.append("div").classed(g+"-est-completed",!0).call(k,F);var H=function(a){return x(a.get("actStartDate"))},I=function(a){return y(a.get("actStartDate"),a.get("actEndDate"))},J=D.filter(function(a){return a.get("actStartDate")&&a.get("actEndDate")}).append("div").classed(g+"-act",!0).classed("bar",!0).call(l,H);J.append("div").classed(g+"-act-full",!0).call(m,I),J.append("div").classed(g+"-act-completed",!0).call(n,I),z.call(f.bind(q.appendGroupCell,q)),z.exit().remove(),z.enter().append("td").call(f.bind(q.appendGroupCell,q)),z.order(),A.select("div.inner").style("width",d.plusPx(q.get("unitCellWidth"))).select("div.background").style("background-color",f.bind(q.getUnitBackgroundColor,q)).style("width",d.plusPx(q.get("unitCellWidth"))).text(f.bind(q.getUnitText,q)),A.exit().remove(),A.enter().append("td").classed("day-cell",!0).append("div").classed("inner",!0).style("width",d.plusPx(q.get("unitCellWidth"))).append("div").classed("background",!0).style("background-color",f.bind(q.getUnitBackgroundColor,q)).style("width",d.plusPx(q.get("unitCellWidth"))).text(f.bind(q.getUnitText,q)),A.order()}},displayPopup:function(a){var b=a.get("gantt");return function(a){var c=e.event,d=[(c.pageX||c.clientX)+5,(c.pageY||c.clientY)+5],g=e.select(".taskpopup");g.select(".corner").style("border-right-color",a.getBarColor().toString()),g.select(".taskname").text(a.get("name"));for(var h=g.select("table.taskdata"),i=h.node();i.hasChildNodes();)i.removeChild(i.lastChild);f.each(b.get("columns"),function(b){b.renderPopupData(h,a)}),g.style("display","block");var j=g.node().clientWidth,k=g.node().clientHeight,l=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,m=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;c.clientX+j+30>l&&(d[0]-=j+10),c.clientY+k+30>m&&(d[1]-=k+10),g.style("left",d[0]+"px").style("top",d[1]+"px")}},hidePopup:function(){e.select(".taskpopup").style("display","none")}})}),c("intervals/interval",["require","util/base","d3","underscore"],function(a){var b=a("util/base"),c=a("d3"),d=a("underscore");return b.extend({defaults:{name:"",unitWidth:20,unitCellWidth:19,unitFormat:c.time.format("%-d"),unitInterval:c.time.day,groupInterval:c.time.week},getUnitBackgroundColor:function(){},getMinGroup:function(){},getMaxGroup:function(){},setDomain:function(a){this.set("domain",a)},setRange:function(a){this.set("range",a)},getUnitSteps:function(){return this.get("unitInterval").range.apply(void 0,this.get("domain"))},getGroupSteps:function(){return this.get("groupInterval").range.apply(void 0,this.get("domain"))},getGroupText:function(){},appendGroupCell:function(){},getUnitText:function(){},getXScale:function(){var a=c.time.scale().domain(this.get("domain")).rangeRound(this.get("range"));return a},getWidthScale:function(){var a=this.getXScale(),b=this.correctDate;return function(c,d){return a(b(d))-a(c)}},correctDate:function(a){var b=function(a){return c.time.day.offset(a,1)};return d.isFunction(a)?d.compose(b,a):b(a)}})}),c("intervals/dayinterval",["require","intervals/interval","util/base","util/util","d3","underscore"],function(a){var b=a("intervals/interval"),c=a("util/base"),d=a("util/util"),e=a("d3"),f=a("underscore");return b.extend({defaults:{name:"day",unitWidth:20,unitCellWidth:19,unitFormat:e.time.format("%-d"),unitInterval:e.time.day,groupInterval:e.time.week},getMinGroup:function(a,b){var f=this.get("groupInterval"),g=d.accessorFilter(a,b),h=c.prototype.accessor(b);return g.length?f.floor(e.min(g,h)):null},getMaxGroup:function(a,b){var f=this.get("groupInterval"),g=d.accessorFilter(a,b),h=c.prototype.accessor(b);return g.length?f.ceil(e.max(g,h)):null},getUnitBackgroundColor:function(a,b){var c=this.get("unitInterval");return c.floor(a).getTime()==c.floor(new Date).getTime()?"#dbd":0==b%7||6==b%7?"#eee":""},getGroupText:function(a){return d.fullDateFormat(a)+" to "+d.fullDateFormat(this.get("unitInterval").offset(a,6))},appendGroupCell:function(a){a.classed("date-range",!0).attr("colspan",7).text(f.bind(this.getGroupText,this))},getGroupSteps:function(){return f.filter(this.get("unitInterval").range.apply(void 0,this.get("domain")),function(a,b){return 0==b%7})},getUnitText:function(a){return this.get("unitFormat")(a)}})}),c("intervals/weekinterval",["require","intervals/interval","util/base","util/util","d3"],function(a){var b=a("intervals/interval"),c=a("util/base"),d=a("util/util"),e=a("d3");return b.extend({defaults:{name:"week",unitWidth:40,unitCellWidth:39,unitFormat:e.time.format("%-m/%-d"),unitInterval:e.time.week,groupInterval:e.time.year},getMinGroup:function(a,b){var f=this.get("unitInterval"),g=d.accessorFilter(a,b),h=c.prototype.accessor(b);return g.length?f.floor(e.min(g,h)):null},getMaxGroup:function(a,b){var f=this.get("unitInterval"),g=d.accessorFilter(a,b),h=c.prototype.accessor(b);return g.length?f.ceil(e.max(g,h)):null},getUnitBackgroundColor:function(a){var b=this.get("unitInterval");return b.floor(a).getTime()==b.floor(new Date).getTime()?"#dbd":""},getGroupText:function(a){return a.getFullYear()},appendGroupCell:function(a){a.classed("date-range",!0).attr("colspan",void 0).text(this.getGroupText)},getGroupSteps:function(){return this.getUnitSteps()},getUnitText:function(a){return this.get("unitFormat")(a)}})}),c("intervals/monthinterval",["require","intervals/interval","util/base","util/util","d3"],function(a){var b=a("intervals/interval"),c=a("util/base"),d=a("util/util"),e=a("d3");return b.extend({defaults:{name:"month",unitWidth:60,unitCellWidth:59,unitFormat:e.time.format("%b"),unitInterval:e.time.month,groupInterval:e.time.year},getMinGroup:function(a,b){var f=this.get("unitInterval"),g=d.accessorFilter(a,b),h=c.prototype.accessor(b);return g.length?f.floor(e.min(g,h)):null},getMaxGroup:function(a,b){var f=this.get("unitInterval"),g=d.accessorFilter(a,b),h=c.prototype.accessor(b);return g.length?f.ceil(e.max(g,h)):null},getUnitBackgroundColor:function(a){var b=this.get("unitInterval");return b.floor(a).getTime()==b.floor(new Date).getTime()?"#dbd":""},getGroupText:function(a){return a.getFullYear()},appendGroupCell:function(a){a.classed("date-range",!0).attr("colspan",void 0).text(this.getGroupText)},getGroupSteps:function(){return this.getUnitSteps()},getUnitText:function(a){return this.get("unitFormat")(a)}})}),c("util/colors",["require","d3"],function(a){var b=a("d3"),c=["#ff00ff","#00ff00","#0000ff","#ff0000","#669900","#6600ff","#996633","#0ffff0","#ffcc00","#ffff00"];return{brights:b.scale.ordinal().range(c),lights:b.scale.category10()}}),c("ganttd3",["require","backbone","util/base","tasks/task","tasks/taskcollection","columns/column","columns/tasknamecolumn","columns/taskbarscolumn","intervals/dayinterval","intervals/weekinterval","intervals/monthinterval","util/colors","d3","underscore"],function(a){var b=(a("backbone"),a("util/base")),c=a("tasks/task"),d=a("tasks/taskcollection"),e=a("columns/column"),f=a("columns/tasknamecolumn"),g=a("columns/taskbarscolumn"),h=a("intervals/dayinterval"),i=a("intervals/weekinterval"),j=a("intervals/monthinterval"),k=a("util/colors"),l=a("d3"),m=a("underscore");return b.extend({constructor:function(a,n){b.apply(this);var o=this,p=m.defaults(n||{},{rowHeight:25,barHeight:9,groupHeight:7,barCompletionHeight:3,groupCompletionHeight:3,pathSeparator:".",colorGenerator:function(a){if(a.get("group"))return{bar:"black",completion:"#555"};var b=k.lights(m.reduce(a.get("id").split(""),function(a,b){return a+b.charCodeAt()},0));return{bar:b,completion:l.rgb(b).brighter().toString()}},interval:new i,useDayInterval:function(){this.interval=new h,o.redraw()},useWeekInterval:function(){this.interval=new i,o.redraw()},useMonthInterval:function(){this.interval=new j,o.redraw()}});this.set("settings",p);var q=new f({gantt:this}),r=new e({gantt:this,name:"duration",label:"Est. Duration",accessor:c.prototype.method("getEstDuration")}),s=new e({gantt:this,name:"percent-completed",label:"% Completed",accessor:c.prototype.method("getPercentCompletion")}),t=new e({gantt:this,name:"est-start-date",label:"Est. Start Date",accessor:c.prototype.method("getFormattedDate","estStartDate")}),u=new e({gantt:this,name:"est-end-date",label:"Est. End Date",accessor:c.prototype.method("getFormattedDate","estEndDate")}),v=new e({gantt:this,name:"act-start-date",label:"Act. Start Date",accessor:c.prototype.method("getFormattedDate","actStartDate")}),w=new e({gantt:this,name:"act-end-date",label:"Act. End Date",accessor:c.prototype.method("getFormattedDate","actEndDate")}),x=new g({gantt:this}),y=[q,r,s,t,u,v,w,x];this.set("columns",y);var z=new d;z.on("add remove",this.redraw,this),this.set("data",z);var A=l.select(a).append("table");this.set("selection",A);var B=A.append("tr").classed("date-ranges",!0).style("opacity",0);B.transition().delay(200).duration(200).style("opacity",1),B.append("td").classed("spacer",!0).attr("colspan",y.length-1);var C=A.append("tr").classed("columns",!0).style("opacity",0);C.transition().delay(200).duration(200).style("opacity",1),this.drawColumnHeadings(C),this.redraw()},createTask:function(a){return a=a||{},a.gantt=this,new c(a)},add:function(a){var b=this;this.get("settings"),a.has("gantt")||a.set("gantt",b);for(var c,d,e=a.get("path").slice(0),f=this.get("data").models;e.length;){if(d=e.shift(),c=m.find(f,function(a){return a.get("pathName")===d}),!c)throw'Component "'+d+'" in path "'+a.get("path")+'" does not exist';f=c.get("tasks")}a.set("parent",c),f.push(a)},flattenTree:function(a){var b=[];return m.each(a,function(a){b.push(a),b.push(this.flattenTree(a.get("tasks")))},this),m.chain(b).flatten().compact().value()},redraw:function(){var a=this.get("selection"),b=this.flattenTree(this.get("data").models),d=a.selectAll("tr.row").data(m.filter(b,function(a){return a.get("visible")}),c.prototype.accessor("id")),e=d.enter().append("tr").classed("row",!0);d.classed("group",c.prototype.accessor("group")).style("font-weight",c.prototype.method("getRowFontWeight")),d.exit().remove(),d.order(),this.drawColumns(d,e)},drawColumnHeadings:function(a){m.each(this.get("columns"),function(b){b.renderHeading(a)})},drawColumns:function(a,b){m.each(this.get("columns"),function(c){c.render(a,b)})}})}),b("ganttd3")});